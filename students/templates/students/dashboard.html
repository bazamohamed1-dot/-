{% extends 'base.html' %}

{% block header_title %}لوحة القيادة{% endblock %}

{% block content %}
<div class="grid-4">
    <div class="card" style="border-right: 4px solid var(--primary);">
        <div style="font-size: 3rem; color: var(--primary); margin-bottom: 10px;"><i class="fas fa-users"></i></div>
        <div style="font-size: 1.5rem; font-weight: bold;">{{ total_students }}</div>
        <div style="color: #64748b;">مجموع التلاميذ</div>
    </div>

    <div class="card" style="border-right: 4px solid var(--success);">
        <div style="font-size: 3rem; color: var(--success); margin-bottom: 10px;"><i class="fas fa-utensils"></i></div>
        <div style="font-size: 1.5rem; font-weight: bold;">{{ half_board_count }}</div>
        <div style="color: #64748b;">تلاميذ نصف داخلي</div>
    </div>

    <div class="card" style="border-right: 4px solid var(--warning);">
        <div style="font-size: 3rem; color: var(--warning); margin-bottom: 10px;"><i class="fas fa-chalkboard-teacher"></i></div>
        <div style="font-size: 1.5rem; font-weight: bold;">4</div>
        <div style="color: #64748b;">المستويات الدراسية</div>
    </div>

    <div class="card" style="border-right: 4px solid var(--danger);">
        <div style="font-size: 3rem; color: var(--danger); margin-bottom: 10px;"><i class="fas fa-database"></i></div>
        <div style="font-size: 1.2rem; font-weight: bold;">{{ db_status }}</div>
        <div style="color: #64748b;">حالة قاعدة البيانات</div>
    </div>
</div>

<div class="grid-2 mt-4">
    <div class="card">
        <!-- School Stats (Placeholder as requested) -->
        <h3><i class="fas fa-school"></i> إحصائيات التمدرس ليوم: <span id="schoolStatsDate" class="western-nums" style="direction:ltr;">--/--/----</span></h3>
        <div style="margin-top: 15px;">
            <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 10px 0;">
                <span>عدد الحضور اليوم:</span>
                <span style="font-weight: bold; color: var(--success);">0</span> <!-- Placeholder -->
            </div>
            <div style="display: flex; justify-content: space-between; padding: 10px 0;">
                <span>عدد الغياب اليوم:</span>
                <span style="font-weight: bold; color: var(--danger);">0</span> <!-- Placeholder -->
            </div>
        </div>
    </div>

    <div class="card">
        <h3><i class="fas fa-utensils"></i> إحصائيات المطعم ليوم: <span id="canteenStatsDate" class="western-nums" style="direction:ltr;">--/--/----</span> في الفترة 12:00 إلى 13:00</h3>
        <div style="margin-top: 15px;">
            <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 10px 0;">
                <span>عدد الحضور اليوم:</span>
                <span style="font-weight: bold; color: var(--success);">{{ present_today }}</span>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 10px 0;">
                <span>عدد الغياب اليوم:</span>
                <span style="font-weight: bold; color: var(--danger);">{{ absent_today }}</span>
            </div>
        </div>
    </div>
</div>

<div class="card mt-4" style="border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); border-radius: 12px; overflow: hidden;">
    <div style="background-color: #f8fafc; padding: 15px 20px; border-bottom: 1px solid #e2e8f0;">
        <h3 style="color: var(--primary); margin: 0; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-chart-bar"></i> التعداد العام حسب المستوى والتمدرس
        </h3>
    </div>
    <div style="overflow-x: auto;">
        <table style="width:100%; border-collapse: collapse;">
            <thead>
                <tr style="background:#f1f5f9; text-align:center;">
                    <th style="padding:15px; font-weight:700; color:#475569; border-left:1px solid #e2e8f0;">المستوى</th>
                    <th style="padding:15px; font-weight:700; color:#1e40af; border-left:1px solid #e2e8f0;">نصف داخلي</th>
                    <th style="padding:15px; font-weight:700; color:#4b5563; border-left:1px solid #e2e8f0;">خارجي</th>
                    <th style="padding:15px; font-weight:700; color:#0f172a;">المجموع</th>
                </tr>
            </thead>
            <tbody>
                {% for item in detailed_stats %}
                <tr style="border-bottom: 1px solid #f1f5f9; text-align:center; transition: background 0.2s;">
                    <td style="padding:15px; font-weight:700; color:#334155; border-left:1px solid #f1f5f9;">{{ item.level }}</td>
                    <td style="padding:15px; font-weight:600; color:#1e40af; background:#eff6ff; border-left:1px solid #white;" class="western-nums">{{ item.half }}</td>
                    <td style="padding:15px; font-weight:600; color:#4b5563; border-left:1px solid #f1f5f9;" class="western-nums">{{ item.ext }}</td>
                    <td style="padding:15px; font-weight:bold; color:#0f172a;" class="western-nums">{{ item.total }}</td>
                </tr>
                {% empty %}
                <tr><td colspan="4" style="text-align:center; padding:20px; color:#94a3b8;">لا توجد بيانات متاحة حالياً</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Set dates with Western numerals using ar-DZ locale with latn numbering
        const today = new Date().toLocaleDateString('ar-DZ', { numberingSystem: 'latn' });
        document.getElementById('schoolStatsDate').textContent = today;
        document.getElementById('canteenStatsDate').textContent = today;
    });
</script>
{% endblock %}
{% endblock %}
